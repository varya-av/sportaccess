<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Вход через Telegram</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <style>
    body{display:flex;align-items:center;justify-content:center;min-height:100vh;background:#f7fbff}
    .card{background:#fff;border:1px solid #e6eff7;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.06);padding:24px;max-width:520px;width:92%}
    h1{margin:0 0 10px;font-size:22px;color:#0b3558}
    p{margin:6px 0 14px;color:#406080}
    .help{font-size:13px;color:#6e8ba6}
    .hr{height:1px;background:#e6eff7;margin:16px 0}
    .fallback{margin-top:10px}
    .fallback a{display:inline-block;padding:10px 14px;border:1px solid #b2d4ff;border-radius:10px;text-decoration:none}
    .err{margin-top:12px;color:#b01030;font-size:13px;display:none}
  </style>
</head>
<body>
  <div class="card">
    <h1>Войти через Telegram</h1>
    <p>Нажмите кнопку ниже. Мы не получаем доступа к переписке — только публичные данные профиля (имя, username, id).</p>

    <!-- Контейнер, куда Telegram заменит скрипт кнопкой -->
    <div id="tg-button">
      <script async src="https://telegram.org/js/telegram-widget.js?7"
              data-telegram-login="SportCityKorolevBot"
              data-size="large"
              data-userpic="false"
              data-auth-url="https://glamorous-wash-production.up.railway.app/tg_auth"
              data-request-access="write">
      </script>
    </div>

    <div class="hr"></div>
    <p class="help">Если кнопка не появилась в течение 2–3 секунд:</p>
    <ol class="help">
      <li>Откройте страницу заново обычным браузером (не во «встроенном» браузере Telegram).</li>
      <li>Проверьте, не блокирует ли сеть загрузку <code>telegram.org</code>.</li>
      <li>Попробуйте этот прямой запуск: <a target="_blank" rel="noopener" href="https://telegram.org/js/telegram-widget.js?7">проверить загрузку скрипта</a>.</li>
    </ol>

    <div id="err" class="err"></div>

    <div class="fallback">
      <a href="/" onclick="location.reload();return false;">Перезагрузить страницу</a>
    </div>
  </div>

  <script>
    // Если виджет не подгрузился, покажем текст ошибки
    setTimeout(() => {
      const btn = document.querySelector('#tg-button .telegram-login-widget');
      if (!btn) {
        const e = document.getElementById('err');
        e.style.display = 'block';
        e.textContent = 'Кнопка Telegram не загрузилась. Проверьте соединение/блокировки.';
      }
    }, 2500);
  </script>
</body>
</html>
